<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{fragments/imports :: headTags}"></th:block>

<body>
    <th:block th:replace="~{fragments/header :: navbar('Admin Dashboard')}">
    </th:block>


    <!-- users form for edit  -->
    <div id="edit_form_container" class="container card p-4 shadow my-5">
        <h3>Edit the admin users</h3>
        <p>You need at least one admin user (max 5)</p>

        <div>
            <div class="d-flex flex-column">

                <div class="table-responsive">
                    <table class="table table-primary">
                        <thead>
                            <tr>
                                <th scope="col">Username</th>
                                <th scope="col">Email</th>
                                <th class="text-center" scope="col">Actions</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="user, iterStat : ${users}" th:object="${user}">
                                <td scope="row">[[*{getUsername()}]]</td>
                                <td>[[*{getEmail()}]]</td>
                                <td>
                                    <div class="d-flex align-items-center justify-content-center gap-4">
                                        <a class="btn btn-warning"
                                            th:href="@{/admin/users/edit/{id}(id=*{getId()})}">Edit</a>
                                        <form action="">
                                            <button type="submit" class="btn btn-danger">Delete</button>
                                        </form>
                                    </div>

                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>


                <!-- 
                <div>
                    <form th:action="@{/admin/users/update/{id}(id=${user.id})}" method="post">
                        <input type="hidden" name="_csrf" th:value="${_csrf.token}" />

                        <div>
                            <label>Username</label>
                            <input th:value="*{username}" class="form-control" />
                        </div>

                        <div>
                            <label>Email</label>
                            <input th:value="*{email}" class="form-control" />
                        </div>

                        <div>
                            <label>Password</label>
                            <input th:value="*{password}" class="form-control" />
                        </div>

                        <button type="submit" class="btn btn-primary">Update</button>
                    </form>
                </div> -->



                <!-- <form action="" th:object="${user}">
                    <div class=" mb-3">
                        <label class="form-label">Username</label>
                        <input th:field="*{username}" type="text" class="form-control" th:errorClass="is-invalid"
                            placeholder="business@domain.com" required />
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input th:field="*{email}" type="email" class="form-control" th:errorClass="is-invalid"
                            placeholder="email@example.com" required />
                        <small th:unless="${#fields.hasErrors('users[' + iterStat.index + '].email')}"
                            class="form-text text-muted">Insert email</small>
                        <small th:if="${#fields.hasErrors('users[' + iterStat.index + '].email')}"
                            th:each="err : ${#fields.errors('users[' + iterStat.index + '].email')}" th:text="${err}"
                            class="form-text text-muted invalid-feedback"></small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input th:name="'users[' + ${iterStat.index} + '].password'" th:value="${user.password}"
                            type="text" class="form-control" th:errorClass="is-invalid" placeholder="Enter password"
                            required />
                        <small th:unless="${#fields.hasErrors('users[' + iterStat.index + '].password')}"
                            class="form-text text-muted">Insert password</small>
                        <small th:if="${#fields.hasErrors('users[' + iterStat.index + '].password')}"
                            th:each="err : ${#fields.errors('users[' + iterStat.index + '].password')}" th:text="${err}"
                            class="form-text text-muted invalid-feedback"></small>
                    </div>
                </form> -->

                <!-- non funziona bene  -->
                <!-- <form th:action="@{/admin/users/delete/{id}(id=${user.id})}" method="POST">
                    <input type="hidden" name="_csrf" th:value="${_csrf.token}" />

                    <button type="submit" class="btn btn-danger">Delete</button>
                </form> -->

                <hr class="my-5">
            </div>

        </div>

        <!-- <div class="w-100 text-center my-5">
                        <button id="addUserBtn" type="button" class="btn btn-success">
                            <i class="bi bi-file-plus-fill"></i> Add User
                        </button>
                    </div> -->
    </div>



    <th:block th:replace="~{fragments/footer :: footer}">
    </th:block>
    <th:block th:replace="~{fragments/imports :: scripts}"></th:block>
</body>


</html>